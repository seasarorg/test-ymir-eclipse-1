<profile>
  <id>executable</id>
  <build>
    <pluginManagement>
      <plugins>
        <plugin>
          <artifactId>maven-war-plugin</artifactId>
          <version>2.0</version>
          <configuration>
            <warSourceDirectory>${basedir}/src/main/web-resource</warSourceDirectory>
            <webResources>
              <resource>
                <directory>${basedir}/src/main/webapp</directory>
                <excludes>
                  <exclude>WEB-INF/classes/</exclude>
                  <exclude>WEB-INF/lib/</exclude>
                </excludes>
              </resource>
              <resource>
                <directory>${basedir}/target/generated-resources</directory>
              </resource>
            </webResources>
            <archive>
              <manifest>
                <mainClass>org.seasar.cms.executablewar.Main</mainClass>
              </manifest>
            </archive>
          </configuration>
        </plugin>
      </plugins>
    </pluginManagement>
    <plugins>
      <plugin>
        <groupId>org.jvnet.maven-antrun-extended-plugin</groupId>
        <artifactId>maven-antrun-extended-plugin</artifactId>
        <executions>
          <execution>
            <id>resgen</id>
            <!-- Should use 'prepare-package' on Maven 2.1 or later. -->
            <phase>generate-resources</phase>
            <goals>
              <goal>run</goal>
            </goals>
            <configuration>
              <tasks>
                <mkdir dir="target/generated-resources" />
                <!-- put executable war header -->
                <resolveArtifact artifactId="executable-war" property="executable-war.jar" />
                <unjar src="${executable-war.jar}" dest="target/generated-resources">
                  <patternset>
                    <include name="**/*.class" />
                    <include name="**/*.jar" />
                  </patternset>
                </unjar>
              </tasks>
            </configuration>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>
  <pluginRepositories>
    <pluginRepository>
      <id>java.net2</id>
      <url>http://download.java.net/maven/2</url>
      <releases>
        <enabled>true</enabled>
        <updatePolicy>never</updatePolicy>
      </releases>
    </pluginRepository>
  </pluginRepositories>
  <dependencies>
    <dependency>
      <groupId>org.seasar.cms.executable-war</groupId>
      <artifactId>executable-war</artifactId>
      <version>0.0.1</version>
      <scope>provided</scope>
    </dependency>
  </dependencies>
</profile>
